 <!DOCTYPE doctype html>
    <html lang="en">
        <head>
            <link href="https://i.imgur.com/UwGDzXn.png" rel="shortcut icon" type="image/x-icon" />
            <title>Pytest HTML Reporter</title>
            <meta charset="utf-8" />
            <meta content="width=device-width, initial-scale=1" name="viewport" />
            <link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" crossorigin="anonymous"/>
            <link href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css" rel="stylesheet" crossorigin="anonymous" />
            <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
            <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" crossorigin="anonymous"/>
            <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" crossorigin="anonymous"/>
            <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
            <!-- Bootstrap core Datatable-->
            <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js" type="text/javascript" crossorigin="anonymous"></script>
            <script src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js" type="text/javascript"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" type="text/javascript"></script>
            <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js" type="text/javascript"></script>
            <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.print.min.js" type="text/javascript"></script>
            <script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.colVis.min.js" type="text/javascript"></script>
            <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0" type="text/javascript"></script>
            <style>
                body {
                    font-family: -apple-system, sans-serif;
                    background-color: #eeeeee;
                    padding-top: 72px; /* offset for fixed top navigation */
                }

                .sidenav {
                    height: 100%;
                    width: 220px;
                    position: fixed;
                    z-index: 1;
                    top: 0;
                    left: 0;
                    background-color: #211f1f;
                    overflow-x: hidden;
                }

                .sidenav a {
                    padding: 12px 10px 8px 12px;
                    text-decoration: none;
                    font-size: 18px;
                    color: #a2a2a2;
                    display: block;
                }

                .main {
                    padding-top: 10px;
                    margin-top: 0; /* ensure content starts below fixed nav */
                }

                @media screen and (max-height: 450px) {
                    .sidenav {
                        padding-top: 15px;
                    }
                    .sidenav a {
                        font-size: 18px;
                    }
                }

                .wrimagecard {
                    margin-top: 0;
                    margin-bottom: 0.6rem;
                    border-radius: 5px;
                    transition: all 0.3s ease;
                    background-color: #f8f9fa;
                }

                .rowcard {
                    # padding-top: 10px;
                    box-shadow: 12px 15px 20px 0px rgba(46, 61, 73, 0.15);
                    border-radius: 6px;
                    transition: all 0.3s ease;
                    # background-color: white;
                }

                .tablecard {
                    background-color: white;
                    font-size: 14px;
                }
                tr {
                    height: 40px;
                }

                .dt-buttons {
                    margin-left: 5px;
                }
                th, td, tr {
                    text-align:center;
                    vertical-align: middle;
                }

                /* Top navigation (replacing left sidenav) */
                .topnav {
                    position: fixed;
                    top: 0;
                    width: 100%;
                    background-color: #000000;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    padding: 8px 12px;
                    z-index: 1000;
                }
                .topnav a {
                    text-decoration: none;
                    font-size: 16px;
                    color: #a2a2a2;
                    padding: 8px 12px;
                    border-right: none;
                    display: inline-flex; /* ensure background fills the whole tab */
                    align-items: center;
                    gap: 6px;
                    border-radius: 6px;
                    height: 40px;
                    box-sizing: border-box;
                }
                .topnav a:hover {
                    color: white;
                }

                .loader {
                    position: fixed;
                    left: 0px;
                    top: 0px;
                    width: 100%;
                    height: 100%;
                    z-index: 9999;
                    background: url('https://i.imgur.com/n3Tcoxz.gif') 50% 50% no-repeat rgb(249, 249, 249);
                }

                .card-wrapper {
                  background-color: #f5f5f5;
                  # height: 100vh;
                  # width: 100vw;
                  display: grid;
                }

                .card {
                  background-color: #ffff;
                  display: flex;
                  flex-direction: column;
                  # place-self: center;
                  border-radius: 4px;
                  box-shadow: 1px 1px 4px rgba(0,0,0,0.4);
                }

                .card__content {
                  padding: 1.5rem;
                  font-family: sans-serif;
                }

                .time__taken {
                    color: darkgray;
                    font-size: 17px;
                }

                .card__header {
                  display: flex;
                  flex-direction: row;
                  justify-content: space-between;
                }

                .header__title {
                  font-size: 1.5rem;
                  font-weight: 600;
                  font-family: sans-serif;
                  padding-top: 4%;
                  padding-left: 5%;
                  color: dimgrey;
                  /* prevent long titles from pushing layout */
                  max-width: 70%;
                  display: -webkit-box;
                  -webkit-line-clamp: 2;           /* clamp to two lines */
                  -webkit-box-orient: vertical;
                  overflow: hidden;
                  white-space: normal;
                  word-break: break-word;
                }

                /* Top title panel below nav */
                .title-panel {
                    margin: 8px 12px 0 12px;
                    text-align: center; /* center align dashboard title */
                }
                .title-text {
                    font-size: 1.6rem;
                    font-weight: 600;
                    font-family: sans-serif;
                    color: dimgrey;
                    max-width: 100%;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    margin: 0 auto; /* ensure centered within panel */
                }

                /* Test Metrics cards */
                .test-cards {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                    grid-gap: 16px;
                }
                .test-card {
                    border-radius: 8px;
                    box-shadow: 1px 1px 4px rgba(0,0,0,0.2);
                    overflow: hidden;
                    background: #ffffff;
                    border: 1px solid rgba(0,0,0,0.1);
                }
                .test-card__header {
                    padding: 12px 16px;
                    color: #111;
                    font-weight: 700;
                    font-size: 1.4rem;
                }
                .test-card__body {
                    padding: 14px 16px 18px 16px;
                    background: #fafafa;
                }
                .status-label {
                    font-weight: 800;
                    font-size: 1.6rem;
                    letter-spacing: 0.5px;
                }
                .duration-label {
                    margin-top: 8px;
                    font-size: 1.1rem;
                    color: #333;
                }
                .suite-label {
                    margin-bottom: 6px;
                    font-size: 1.1rem;
                    color: #666;
                }
                .test-card[data-status="PASS"] .test-card__header { background: #98cc64; }
                .test-card[data-status="FAIL"] .test-card__header { background: #fc6766; }
                .test-card[data-status="ERROR"] .test-card__header { background: #b13635; color: #fff; }
                .test-card[data-status="SKIP"] .test-card__header { background: #ffd050; }

                /* Simple pagination styles */
                .tm-pagination {
                    display: flex;
                    gap: 8px;
                    align-items: center;
                    margin: 12px 0 8px 0;
                    flex-wrap: wrap;
                }
                .tm-pagination .pg-btn {
                    padding: 6px 10px;
                    border: 1px solid #ccc;
                    background: #fff;
                    border-radius: 4px;
                    cursor: pointer;
                }
                .tm-pagination .pg-btn.active {
                    background: #efefef;
                    border-color: #999;
                    font-weight: 700;
                }
                .tm-pagination .pg-btn[disabled] {
                    opacity: 0.5;
                    cursor: not-allowed;
                }

                /* Suite Metrics cards */
                .suite-cards {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
                    grid-gap: 16px;
                }
                .suite-card {
                    border-radius: 8px;
                    box-shadow: 1px 1px 4px rgba(0,0,0,0.2);
                    overflow: hidden;
                    background: #ffffff;
                    border: 1px solid rgba(0,0,0,0.1);
                }
                .suite-card__header {
                    padding: 12px 16px;
                    color: #111;
                    font-weight: 700;
                    font-size: 1.3rem;
                    background: #f2f2f2;
                }
                .suite-card__body {
                    padding: 14px 16px 18px 16px;
                    background: #fafafa;
                }
                .suite-counts { display:flex; gap:14px; flex-wrap:wrap; }
                .badge-count { padding:6px 10px; border-radius:6px; font-weight:700; }
                .badge-pass { background:#e7f4dc; color:#2f6b00; }
                .badge-fail { background:#fde0df; color:#7a1110; }
                .badge-skip { background:#fff1cc; color:#7a5d00; }
                .badge-error { background:#f1d9dc; color:#5e0e11; }

                .header__date {
                  font-size: 1.3rem;
                  font-family: sans-serif;
                  padding-left: 5%;
                  color: darkgray;
                }

                /* Test Metrics summary */
                .tm-summary {
                    margin-bottom: 12px;
                }
                .tm-summary-title {
                    font-size: 1.4rem;
                    font-weight: 700;
                    color: #333;
                }
                .tm-summary-top {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 6px;
                }
                .tm-items { color: #666; font-weight: 600; }
                .tm-counts { display: flex; gap: 16px; flex-wrap: wrap; }
                .tm-count { font-weight: 800; font-size: 1.2rem; }
                .tm-count.pass { color: #98cc64; }
                .tm-count.fail { color: #fc6766; }
                .tm-count.skip { color: #ffd050; }
                .tm-count.error { color: #b13635; }

                /* Grouped suites in Test Metrics */
                .suite-group { margin-bottom: 18px; }
                .suite-group__title {
                    font-weight: 700;
                    font-size: 1.2rem;
                    color: #555;
                    margin: 10px 0 10px 0;
                    border-left: 4px solid #4AACC5;
                    padding-left: 8px;
                }

                .total__count {
                  font-size: 5.3rem;
                  font-family: sans-serif;
                  color: black;
                  padding-top: 8%;
                }

                .total_count__label {
                  font-size: 1.3rem;
                  font-family: sans-serif;
                  padding-left: 12%;
                  color: darkgray;
                }

                .header__title-icon {
                  font-size: 1.6rem;
                  color: #ccc;
                }

                .header__title-icon:hover {
                  color: rgba(54, 162, 235, 1);;
                }

                .header__button {
                  border-radius: 50px;
                  background-color: #f5f5f5;
                  padding: 0.5rem 1rem;
                  border: none;
                  margin-left: 1rem;
                }

                .header__button:hover {
                  background-color: rgba(54, 162, 235, 0.25);
                }

                .chart {
                  padding: 2.0rem 60;
                }

                .card__footer {
                  display: flex;
                  flex-direction: row;
                  justify-content: space-between;
                  margin-bottom: 5%;
                }

                .archive-card__footer {
                  display: flex;
                  flex-direction: row;
                  justify-content: space-between;
                  margin-bottom: 5%;
                  max-width: 60%;
                  padding-top: 5.5%;
                  padding-left: 5%;
                }

                .card__footer-section {
                  text-align: center;
                  width: 33%;
                  # border-right: 1px solid #ccc;
                }

                .archive-card__footer-section {
                  text-align: center;
                }

                .card__footer-section:nth-child(3) {
                  border-right: none;
                }

                .footer-section__data {
                  font-size: 2.6rem;
                  font-weight: 900;
                }

                .archive-footer-section__data {
                  font-size: 4.2rem;
                  font-weight: 700;
                }

                .footer-section__label {
                  text-transform: uppercase;
                  color: slategrey;
                  font-size: 10pt;
                }

                .list-group-item {
                    border: 5px solid rgba(0,0,0,0);
                }

                .list-group {
                    height: 100%;
                    background-color: #ffff;
                    display: flex;
                    flex-direction: column;
                    place-self: center;
                    border-radius: 4px;
                    box-shadow: 1px 1px 4px rgba(0,0,0,0.4);
                }

                .archive-body {
                    background-color: #ffff;
                    max-width: 80%;
                    border-radius: 4px;
                    box-shadow: 1px 1px 4px rgba(0,0,0,0.4);
                    margin-bottom: 0.8%;
                }

                .archive-header {
                    padding-top: 4%;
                    padding-left: 5%;
                    color: gray;
                }

                .archive-date {
                    padding-top: 2%;
                    padding-left: 5%;
                    color: gray;
                }

                .archive-chart-container {
                    height: 50%;
                    width: 48%;
                    margin-left: 40%;
                    margin-top: 6%;
                    position: relative;
                    z-index: 1;
                }

                .statistic-section-pass {
                     padding-top: 51px;
                     padding-bottom: 45px;
                     background: #00c6ff;  /* fallback for old browsers */
                     background: linear-gradient(to right, #333333, #2b4440);
                }

                .statistic-section-fail {
                     padding-top: 51px;
                     padding-bottom: 45px;
                     background: #00c6ff;  /* fallback for old browsers */
                     background: linear-gradient(to right, #333333, #442b2b);
                }

                .count-title {
                    font-size: 50px;
                    font-weight: normal;
                    margin-top: 10px;
                    margin-bottom: 0;
                      text-align: center;
                      font-weight: bold;
                    color: #fff;
                }

                .stats-text {
                    font-size: 15px;
                    font-weight: normal;
                    margin-top: 15px;
                    margin-bottom: 0;
                    text-align: center;
                      color: #fff;
                      text-transform: uppercase;
                      font-weight: bold;
                }

                .stats-line-black {
                    margin: 12px auto 0;
                    width: 55px;
                    height: 2px;
                    background-color: #fff;
                }

                .stats-icon {
                      font-size: 35px;
                      margin: 0 auto;
                    float: none;
                    display: table;
                    color: #fff;
                }

                @media (max-width: 992px) {
                    .counter {
                        margin-bottom: 40px;
                    }
                }

                .archive-build-row {
                    right: 0.5%;
                    width: 220px;
                    top: 0;
                    bottom: 0;
                    position: fixed;
                    overflow-y: scroll;
                    overflow-x: hidden;
                }

                .loading {
                    height: 200px;
                    padding-top: 35px;
                }

                .loading p {
                    font-size: 1.1rem;
                    padding-top: 5%;
                    margin: 0px 0 32px;
                    color: dimgrey;
                    float: right;
                }

                .loading .icon {
                    padding-right: 15px;
                }

                .loading .percentage {
                    float: right;
                }

                .loading .progress-bar {
                    height: 20px;
                    background: #50597b;
                    border-radius: 5px;
                    margin: 0 auto;
                    margin-top: -4%;
                }

                .arrow {
                    left: 50%;
                    color: #403b3b;
                }

                .tooltip {
                    position: relative;
                    display: inline-block;
                    margin: 10px 20px;
                    opacity: 1;
                }

                .tooltip-inner {
                    background-color: #403b3b;
                }

                .bs-tooltip-top .arrow::before {
                    border-top-color: #403b3b;
                }

                .suite-highlights-header {
                    font-size: 0.95rem;
                    padding-top: 5%;
                    margin: 0px 0 45px;
                    color: dimgrey;
                    float: right;
                }

                .desc-video h2 {
                     margin-top: 0px;
                }
                 .desc-video-none {
                     display: none;
                }
                 .video {
                     display: block;
                     position: relative;
                     padding-top: 60%;
                     overflow: hidden;
                     background-repeat: no-repeat;
                     background-position: center center;
                     background-size: cover;
                }
                 .video:hover .video-hover-desc {
                     margin-top: -170px;
                     height: 170px;
                }
                 .video:hover .video-hover-desc:before {
                     background: linear-gradient(to top,rgba(35,72,133,0.82),rgba(35,72,133,0));
                     transition: .3s;
                }
                 .img-hover .text-desc {
                     display: none;
                }
                 .below-desc {
                     display: block;
                     height: 70px;
                     width: 100%;
                     padding: 10px;
                }
                 .video-hover-desc {
                     display: block;
                     padding: 10px 20px;
                     background-color: #234885;
                     background-color: rgba(35,72,133,0.82);
                     height: 90px;
                     margin-top: -90px;
                     transition: .3s;
                     color: white;
                     text-shadow: none;
                }
                 .video-hover-desc:before {
                     display: block;
                     position: absolute;
                     content: '';
                     left: 0;
                     right: 0;
                     height: 116px;
                     transition: .3s;
                     margin-top: -126px;
                }
                 .video-hover-desc h2 {
                     color: white;
                     margin-top: 0px;
                     height: 50px;
                }
                 .video-hover-desc.video-hover-small {
                     height: 50px;
                     margin-top: -50px;
                }
                .modal p {
                    word-wrap: break-word;
                }

                .modal-footer {
                    border-top: 0px solid #e9ecef;
                }
                .btn-primary {
                    background-color: #3571a3;
                    border-color: #3571a3;
                }

                .dashboard__headers {
                    font-size: 1.9rem;
                    color: darkgrey;
                    margin-bottom: -4%;
                }
                /* Insights panel */
                .insight-section { margin-top: 12px; }
                .insight-card { background:#fff; border:1px solid rgba(0,0,0,0.08); border-radius:8px; box-shadow: 1px 1px 4px rgba(0,0,0,0.15); margin-bottom:12px; overflow:hidden; }
                .insight-title { padding:10px 12px; font-weight:700; font-size:1.05rem; color:#555; background:#f7f7f7; border-bottom:1px solid rgba(0,0,0,0.06); }
                .insight-body { padding:10px 12px; }
                .insight-row { margin:6px 0; }
                .insight-row .label { color:#333; font-weight:600; }
                .insight-row .value { float:right; color:#666; }
                .mini-bar { height:8px; background:#eee; border-radius:6px; overflow:hidden; margin-top:6px; }
                .mini-bar .fill-fail { height:100%; background:#fc6766; }
                .mini-bar .fill-slow { height:100%; background:#4AACC5; }
                .metric-muted { color:#888; font-size:0.9rem; }
                .outer_my_chart {
                    margin-left: 50%;
                    margin-top: -40%;
                    max-height: 43%;
                }

                .inner_my_chart {
                    margin-top: 31%;
                    height: 48%;
                    margin-left: 16%;
                    max-width: 75%;
                }

                .archive__chart {
                    width: "440px";
                    height: "440px";
                }

                @media screen and (max-width: 3560px) {
                    .footer-section__data {
                        font-size: 3.6rem;
                    }
                    .suite_count_section {
                        margin-top: -16%;
                    }
                }

                @media screen and (max-width: 2442px) {
                    .outer_my_chart {
                        margin-top: -40%;
                    }
                    .inner_my_chart {
                        margin-top: 31%;
                    }
                    .footer-section__data {
                        font-size: 3.4rem;
                    }
                    .suite_count_section {
                        margin-top: -17%;
                    }
                }

                @media screen and (max-width: 2156px) {
                    .outer_my_chart {
                        margin-top: -42%;
                    }
                    .inner_my_chart {
                        margin-top: 25%;
                    }
                    .suite_count_section {
                        margin-top: -16%;
                    }
                }

                @media screen and (max-width: 1940px) {
                    .outer_my_chart {
                        margin-top: -41%;
                    }
                    .inner_my_chart {
                        margin-top: 16%;
                    }
                    .footer-section__data {
                        font-size: 2.6rem;
                    }
                    .suite_count_section {
                        margin-top: -11%;
                    }
                }

                @media screen and (max-width: 1662px) {
                    .outer_my_chart {
                        margin-top: -45%;
                    }
                }

                @media screen and (max-width: 1307px) {
                    .outer_my_chart {
                        margin-top: -50%;
                    }
                    .px-4 {
                        padding-left: 2.5rem!important;
                    }
                    .loading p {
                        margin: 0px -14px 32px;
                    }
                    .dashboard__headers {
                        font-size: 1.8rem;
                    }
                }

                @media screen and (max-width: 1209px) {
                    .outer_my_chart {
                        margin-top: -41%;
                    }
                    .px-4 {
                        padding-left: 4.5rem!important;
                    }
                    .inner_my_chart {
                        margin-top: 0%;
                    }
                    .footer-section__label {
                        font-size: 8pt;
                    }
                    .time__taken {
                        font-size: 14px;
                    }
                    .total__count {
                        font-size: 4.3rem;
                    }
                    .total_count__label {
                        font-size: 1.2rem;
                    }
                    .loading p {
                        font-size: 0.8rem;
                    }
                    .dashboard__headers {
                        font-size: 1.7rem;
                    }
                    .header__title {
                        font-size: 1.3rem;
                        padding-top: 8%;
                    }
                }

                @media screen and (max-width: 1148px) {
                    .outer_my_chart {
                        margin-top: -43%;
                    }
                    .dashboard__headers {
                        font-size: 1.5rem;
                    }
                    .header__title {
                        font-size: 1.2rem;
                    }
                    .tooltip-inner {
                        font-size: 75%;
                    }
                    .time__taken {
                        font-size: 13px;
                    }
                }

                @media screen and (max-width: 1076px) {
                    .outer_my_chart {
                        margin-top: -52%;
                    }
                    .footer-section__label {
                        font-size: 7pt;
                    }
                    .total__count {
                        padding-top: 13%;
                    }
                }

                @media screen and (max-width: 1031px) {
                    .time__taken {
                        margin-left: -5%;
                    }
                    .dashboard__headers {
                        font-size: 1.3rem;
                    }
                    .suite-highlights-header {
                        font-size: 0.75rem;
                    }
                    .tooltip-inner {
                        font-size: 70%;
                    }
                    .header__title {
                        padding-top: 10%;
                    }
                }

                .total__tests {
                    font-size: 10.3rem;
                    font-family: sans-serif;
                    color: black;
                    padding-top: 8%;
                }

                .archive__label {
                    font-size: 1.8rem;
                    font-family: sans-serif;
                    color: darkgray;
                }

                .archive__bar {
                    padding-top: 8.5%;
                    position: relative;
                    z-index: 0;
                }

                @media screen and (max-width: 1497px) {
                    .total__tests {
                        font-size: 9.3rem;
                    }
                    .archive__label {
                        font-size: 1.7rem;
                    }
                    .archive__bar {
                        padding-top: 4.5%;
                    }
                }

                @media screen and (max-width: 1314px) {
                    .total__tests {
                        font-size: 6.3rem;
                    }
                    .archive__label {
                        font-size: 1.3rem;
                    }
                    .archive__bar {
                        margin-top: -12%;
                        padding-top: 0%;
                    }
                    .count-title {
                        font-size: 40px;
                    }
                    .archive-build-row {
                        right: -2.9%;
                    }
                }

                @media screen and (max-width: 1114px) {
                    .total__tests {
                        font-size: 5.3rem;
                    }
                    .archive__label {
                        font-size: 1.1rem;
                    }
                    .archive__bar {
                        margin-top: -25%;
                        padding-top: 0%;
                    }
                    .count-title {
                        font-size: 40px;
                    }
                    .archive-build-row {
                        right: -4.9%;
                    }
                    .list-group-item {
                        padding: 0.75rem 0.25rem;
                    }
                }

            </style>
            <style>
                .progress-bar.downloading {
                    background: -webkit-linear-gradient(left, #fc6665 %(max_failure_percent)%%,#50597b %(max_failure_percent)%%); /* Chrome10+,Safari5.1+ */
                    background: -ms-linear-gradient(left, #fc6665 %(max_failure_percent)%%,#50597b %(max_failure_percent)%%); /* IE10+ */
                    background: linear-gradient(to right, #fc6665 %(max_failure_percent)%%,#50597b %(max_failure_percent)%%); /* W3C */
                }
                /* Reset chart positioning to earlier behavior */
                .outer_my_chart {
                    margin-left: 50%;
                    margin-top: -40%;
                    max-height: 43%;
                }
                .inner_my_chart {
                    margin-top: 31%;
                    height: 48%;
                    margin-left: 16%;
                    max-width: 75%;
                }
            </style>
        </head>
    <body>
        <div class="loader"></div>
        <div class="topnav">
            <img id="wrimagecard" class="wrimagecard" src="%(custom_logo)%" style="max-height:56px; width:auto;" />
            <a class="tablink" href="#" id="defaultOpen" onclick="event.preventDefault(); openPage('dashboard', this, 'white', '#565656', 'groove')">
                <i class="fa fa-home" id="tablinkicon" style="color:currentcolor;"></i> Dashboard
            </a>
            <a class="tablink" href="#" onclick="event.preventDefault(); openPage('suiteMetrics', this, 'white', '#565656', 'groove'); initSMPagination();">
                <i class="fa fa-briefcase" id="tablinkicon" style="color:currentcolor;"></i> Suites
            </a>
            <a class="tablink" href="#" onclick="event.preventDefault(); openPage('testMetrics', this, 'white', '#565656', 'groove'); initTMPagination();">
                <i class="fa fa-server" id="tablinkicon" style="color:currentcolor;"></i> Test Metrics
            </a>
            <a class="tablink" href="#" onclick="event.preventDefault(); openPage('screenshots', this, 'white', '#565656', 'groove');">
                <i class="fa fa-camera" id="tablinkicon" style="color:currentcolor;"></i> Screenshots
            </a>
        </div>
        <div class="main col-md-12 px-4" style="height: 100%;">
            <div class="tabcontent" id="dashboard">
                <div class="card title-panel">
                  <div class="card__content">
                    <div class="title-text">%(title)%</div>
                  </div>
                </div>

                <div class="row rowcard">
                    <div class="col-md-6 card" style="max-width: 49%;">
                      <div style="width:100%;height:500px;text-align: center;">
                        <div class="card__content">
                          <div style="margin-bottom: -4%; margin-left: 30%;">
                            <span class="time__taken">
                                <svg width="22px" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" style="margin: -1% 2% 0% 29%; -ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 1536 1536"><path d="M896 416v448q0 14-9 23t-23 9H544q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h224V416q0-14 9-23t23-9h64q14 0 23 9t9 23zm416 352q0-148-73-273t-198-198t-273-73t-273 73t-198 198t-73 273t73 273t198 198t273 73t273-73t198-198t73-273zm224 0q0 209-103 385.5T1153.5 1433T768 1536t-385.5-103T103 1153.5T0 768t103-385.5T382.5 103T768 0t385.5 103T1433 382.5T1536 768z" fill="#a9a9a9"/></svg>
                                    Time taken %(execution_time)%
                            </span>
                          </div>
                          <div>
                              <div class="card__header">
                                <span class="header__date">%(date)%</span>
                              </div>
                              <div style="display: flex;">
                                <span class="total__count">%(total)%</span>
                              </div>
                              <div style="display: flex;">
                                <span class="total_count__label">TEST CASES</span>
                              </div>
                          </div>
                          <div>
                              <div class="outer_my_chart">
                                <canvas id="myChart" class="inner_my_chart" style="height: 38%;"></canvas>
                              </div>
                          </div>
                          <div style="margin-top: 23%;position: static;">
                              <div class="suite_count_section">
                                  <div class="card__footer">
                                    <div class="card__footer-section">
                                      <div class="footer-section__data" style="color:#98cc64">%(_pass)%</div>
                                      <div class="footer-section__label">passed</div>
                                    </div>
                                    <div class="card__footer-section">
                                      <div class="footer-section__data" style="color:#fc6766">%(fail)%</div>
                                      <div class="footer-section__label">failed</div>
                                    </div>
                                    <div class="card__footer-section">
                                      <div class="footer-section__data" style="color:#ffd050">%(skip)%</div>
                                      <div class="footer-section__label">skipped</div>
                                    </div>
                                    <div class="card__footer-section">
                                      <div class="footer-section__data" style="color:#b13635">%(error)%</div>
                                      <div class="footer-section__label">error</div>
                                    </div>
                                  </div>
                              </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-md-6 card" style="margin-left: 0.75%;">
                      <a href="#" id="download" download="pytest-html-reporter.pdf" target="_self">
                        <i class="fa fa-download" style="color:dimgrey; font-size: 1.75rem; padding-top: 2%; float: right; position: fixed; right: 50px;"></i>
                      </a>
                      <div style="text-align: center;">
                        <div>
                            <div class="dashboard__headers">
                                <div style="font-weight: 550;font-family: sans-serif;padding-top: 5%;padding-left: 2%;"><i class="fa fa-clock-o" aria-hidden="true"></i>&nbsp;&nbsp;Test Durations (s)
                                </div>
                            </div>
                            <canvas id="durations" width="100%" height="360px" style="margin-top: 10%; max-height: 375px; padding-bottom: 4%;"></canvas>
                        </div>
                      </div>
                    </div>

                </div>

                <div class="row rowcard" style="padding-top: 0.8%;">
                    <div class="col-md-6 card border-right" style="max-width: 49%;">
                        <div class="dashboard__headers">
                            <div style="font-weight: 550;font-family: sans-serif;padding-top: 5%;padding-left: 5%;">
                                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="1.34em" height="1em" style="margin-top: -1%; margin-right: 2%; padding-left: 0.9%; -ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 2048 1536"><path d="M2048 1408v128H0V0h128v1408h1920zM1664 384l256 896H256V704l448-576l576 576z" fill="#a9a9a9"/></svg> Test Suites Execution Result
                            </div>
                        </div>
                        <canvas class="chart" id="groupBarChart" style="margin-top: 6%; height: 451px; width: 100%;"></canvas>
                    </div>
                    <div class="col-md-6" style="margin-left: 0.75%;">
                        <div class="card">
                            <div class="dashboard__headers">
                                <div style="font-weight: 550;font-family: sans-serif;padding-top: 5%;padding-left: 2%;">
                                    <i class="fa fa-exclamation-triangle" style="color:currentcolor; margin-right: 2%; padding-left: 3%;"></i>
                                    Failure rate by suite
                                </div>
                            </div>
                            <div class="card__content insight-section metric-list" id="insightsFailure"></div>
                        </div>
                        <div class="card" style="margin-top: 0.8%;">
                            <div class="dashboard__headers">
                                <div style="font-weight: 550;font-family: sans-serif;padding-top: 5%;padding-left: 2%;">
                                    <i class="fa fa-clock-o" style="color:currentcolor; margin-right: 2%; padding-left: 3%;"></i>
                                    Slowest tests
                                </div>
                            </div>
                            <div class="card__content insight-section metric-list" id="insightsSlow"></div>
                        </div>
                    </div>
                </div>
                <hr/>

                
                <script>
                    window.onload = function() {
                        alignTotalCount();
                        failureScreenshots();
                        // executeDataTable('#tm', 3); // disabled for card layout
                        buildInsights();
                    };
                </script>
                <script>
                    // Build insights: two separate cards (failure rate, slowest tests)
                    function buildInsights(){
                        try{
                            var failEl = document.getElementById('insightsFailure');
                            var slowEl = document.getElementById('insightsSlow');
                            var singleEl = document.getElementById('insightsContent');
                            if(!failEl && !slowEl && !singleEl) return;

                            // Collect suites table data already rendered in charts context
                            var suiteNames = %(test_suites)% || [];
                            var passArr = %(test_suite_pass)% || [];
                            var failArr = %(test_suites_fail)% || [];
                            var skipArr = %(test_suites_skip)% || [];
                            var errorArr = %(test_suites_error)% || [];

                            // Compute failure rate per suite
                            var failureRows = [];
                            for (var i=0;i<suiteNames.length;i++){
                                var total = (passArr[i]||0)+(failArr[i]||0)+(skipArr[i]||0)+(errorArr[i]||0);
                                var failures = (failArr[i]||0)+(errorArr[i]||0);
                                var rate = total>0 ? (failures/total) : 0;
                                failureRows.push({name: suiteNames[i], total: total, failures: failures, rate: rate});
                            }
                            failureRows.sort(function(a,b){ return b.rate - a.rate; });
                            var topFailure = failureRows.slice(0,5);

                            // Slowest tests from durations
                            var durLabels = %(duration_labels)% || [];
                            var durValues = %(duration_values)% || [];
                            var tests = durValues.map(function(v,i){ return {name: durLabels[i], dur: v}; });
                            tests.sort(function(a,b){ return b.dur - a.dur; });
                            var slowTests = tests.slice(0,10);
                            // naive 95th percentile
                            var sortedVals = durValues.slice().sort(function(a,b){return a-b;});
                            var p95 = sortedVals.length ? sortedVals[Math.floor(0.95*(sortedVals.length-1))] : 0;

                            // Skips by reason — approximate using Test Metrics messages that include 'Skipped:'
                            var skipReasonCounts = {};
                            // Messages are not available here; leave placeholder if none

                            var htmlFail = '';
                            htmlFail += '<div class="insight-card">';
                            htmlFail += '<div class="insight-title">Failure rate by suite</div>';
                            htmlFail += '<div class="insight-body">';
                            topFailure.forEach(function(r){
                                var pct = Math.round(r.rate*100);
                                htmlFail += '<div class="insight-row">'
                                     + '<span class="label">'+r.name+'</span>'
                                     + '<span class="value">'+r.failures+'/'+r.total+' ('+pct+'%)</span>'
                                     + '<div class="mini-bar"><div class="fill-fail" style="width:'+pct+'%"></div></div>'
                                     + '</div>';
                            });
                            htmlFail += '</div></div>';

                            var htmlSlow = '';
                            htmlSlow += '<div class="insight-card">';
                            htmlSlow += '<div class="insight-title">Slowest tests <span class="metric-muted">(top 10, p95: '+p95+'s)</span></div>';
                            htmlSlow += '<div class="insight-body">';
                            var maxDur = 0; for(var i=0;i<durValues.length;i++){ if(durValues[i]>maxDur) maxDur = durValues[i]; }
                            slowTests.forEach(function(t){
                                var pct = maxDur ? Math.round((t.dur/maxDur)*100) : 0;
                                htmlSlow += '<div class="insight-row">'
                                     + '<span class="label">'+t.name+'</span>'
                                     + '<span class="value">'+t.dur+'s</span>'
                                     + '<div class="mini-bar"><div class="fill-slow" style="width:'+pct+'%"></div></div>'
                                     + '</div>';
                            });
                            htmlSlow += '</div></div>';

                            if (failEl) failEl.innerHTML = htmlFail;
                            if (slowEl) slowEl.innerHTML = htmlSlow;
                            if (singleEl) singleEl.innerHTML = htmlFail + htmlSlow;
                        }catch(e){ /* no-op */ }
                    }
                </script>
                <script>
                    // Pagination logic for Test Metrics cards
                    function initTMPagination(){
                        var PAGE_SIZE = 20;
                        var container = document.getElementById('tm-cards');
                        if(!container){ return; }
                        // group by suite from existing test cards
                        var allCards = Array.prototype.slice.call(container.children);
                        var groups = {};
                        allCards.forEach(function(node){
                            if(!node.classList || !node.classList.contains('test-card')) return; // Skip non-cards
                            var suiteEl = node.querySelector('.suite-label');
                            var suite = suiteEl ? suiteEl.textContent : 'suite';
                            if(!groups[suite]) groups[suite] = [];
                            groups[suite].push(node);
                        });

                        // rebuild DOM as suite groups each containing a grid of cards
                        var wrapper = document.createElement('div');
                        var suiteNames = Object.keys(groups);
                        suiteNames.forEach(function(suite){
                            var section = document.createElement('div');
                            section.className = 'suite-group';
                            var title = document.createElement('div');
                            title.className = 'suite-group__title';
                            title.textContent = suite;
                            var grid = document.createElement('div');
                            grid.className = 'test-cards';
                            groups[suite].forEach(function(card){ grid.appendChild(card); });
                            section.appendChild(title);
                            section.appendChild(grid);
                            wrapper.appendChild(section);
                        });
                        container.innerHTML = '';
                        container.appendChild(wrapper);

                        // pagination over all cards (flattened)
                        var cards = suiteNames.reduce(function(acc, s){ return acc.concat(groups[s]); }, []);
                        var total = cards.length;
                        var totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
                        var page = 1;

                        function render(){
                            var start = (page-1) * PAGE_SIZE;
                            var end = start + PAGE_SIZE;
                            for (var i=0;i<cards.length;i++){
                                cards[i].style.display = (i>=start && i<end) ? '' : 'none';
                            }
                            // hide empty suite sections after pagination
                            var sections = container.querySelectorAll('.suite-group');
                            sections.forEach(function(sec){
                                var visible = sec.querySelectorAll('.test-card:not([style*="display: none"])').length > 0;
                                sec.style.display = visible ? '' : 'none';
                            });
                            var label = document.getElementById('tm-page-label');
                            if(label){ label.textContent = 'Page ' + page + ' of ' + totalPages; }
                            var prev = document.getElementById('tm-prev');
                            var next = document.getElementById('tm-next');
                            if(prev){ prev.disabled = page<=1; }
                            if(next){ next.disabled = page>=totalPages; }
                        }

                        var prevBtn = document.getElementById('tm-prev');
                        var nextBtn = document.getElementById('tm-next');
                        if(prevBtn){ prevBtn.onclick = function(){ if(page>1){ page--; render(); } }; }
                        if(nextBtn){ nextBtn.onclick = function(){ if(page<totalPages){ page++; render(); } }; }

                        render();
                    }
                </script>
                <script>
                    // Pagination logic for Suite Metrics cards
                    function initSMPagination(){
                        var PAGE_SIZE = 12;
                        var container = document.getElementById('sm-cards');
                        if(!container){ return; }
                        var cards = Array.prototype.slice.call(container.children);
                        var total = cards.length;
                        var totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
                        var page = 1;

                        function render(){
                            var start = (page-1) * PAGE_SIZE;
                            var end = start + PAGE_SIZE;
                            for (var i=0;i<cards.length;i++){
                                cards[i].style.display = (i>=start && i<end) ? '' : 'none';
                            }
                            var label = document.getElementById('sm-page-label');
                            if(label){ label.textContent = 'Page ' + page + ' of ' + totalPages; }
                            var items = document.getElementById('sm-items');
                            if(items){ items.textContent = total + ' suites'; }
                            var prev = document.getElementById('sm-prev');
                            var next = document.getElementById('sm-next');
                            if(prev){ prev.disabled = page<=1; }
                            if(next){ next.disabled = page>=totalPages; }
                        }

                        var prevBtn = document.getElementById('sm-prev');
                        var nextBtn = document.getElementById('sm-next');
                        if(prevBtn){ prevBtn.onclick = function(){ if(page>1){ page--; render(); } }; }
                        if(nextBtn){ nextBtn.onclick = function(){ if(page<totalPages){ page++; render(); } }; }

                        render();
                    }
                </script>
            </div>
            <div class="tabcontent" id="suiteMetrics">
                <div class="tm-summary">
                    <div class="tm-summary-top">
                        <div class="tm-summary-title">Test Summary</div>
                        <div class="tm-items" id="sm-items">0 suites</div>
                    </div>
                    <div class="tm-counts">
                        <div class="tm-count pass">%(_pass)% passed</div>
                        <div class="tm-count fail">%(fail)% failed</div>
                        <div class="tm-count skip">%(skip)% skipped</div>
                        <div class="tm-count error">%(error)% error</div>
                    </div>
                </div>
                <div class="tm-pagination">
                    <button class="pg-btn" id="sm-prev">Prev</button>
                    <div id="sm-page-label" style="margin: 0 8px;">Page 1</div>
                    <button class="pg-btn" id="sm-next">Next</button>
                </div>
                <div class="suite-cards" id="sm-cards">
                    %(suite_metrics_row)%
                </div>
                <div class="row">
                    <div class="col-md-12" style="height:25px;width:auto;"></div>
                </div>
            </div>
        <div class="tabcontent" id="testMetrics">
            <div class="tm-summary">
                <div class="tm-summary-top">
                    <div class="tm-summary-title">Test Summary</div>
                    <div class="tm-items">%(total)% items</div>
                </div>
                <div class="tm-counts">
                    <div class="tm-count pass">%(_pass)% passed</div>
                    <div class="tm-count fail">%(fail)% failed</div>
                    <div class="tm-count skip">%(skip)% skipped</div>
                    <div class="tm-count error">%(error)% error</div>
                </div>
            </div>
            <div class="tm-pagination">
                <button class="pg-btn" id="tm-prev">Prev</button>
                <div id="tm-page-label" style="margin: 0 8px;">Page 1</div>
                <button class="pg-btn" id="tm-next">Next</button>
            </div>
            <div id="tm-cards">%(test_metrics_row)%</div>
            <div class="row">
                <div class="col-md-12" style="height:25px;width:auto;"></div>
            </div>
        </div>
        
        <div class="tabcontent" id="screenshots">
            <div id="content">
              <div class="fold-main">
                <div class="container-fluid">
                  <div id="main-content">
                    <div class="bg-highlight p-4 mt-3">
                      <div class="row">
                        %(attach_screenshot_details)%
                        <div class="below-desc"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
        <script>
            function createBarGraph(tableID, keyword_column, time_column, limit, ChartID, Label, type) {
                var status = [];
                css_selector_locator = tableID + ' tbody >tr'
                var rows = $(css_selector_locator);
                var columns;
                var myColors = [
                    '#4F81BC',
                    '#C0504E',
                    '#9BBB58',
                    '#24BEAA',
                    '#8064A1',
                    '#4AACC5',
                    '#F79647',
                    '#815E86',
                    '#76A032',
                    '#34558B'
                ];
                status.push([type, Label, {
                    role: 'annotation'
                }, {
                    role: 'style'
                }]);
                for (var i = 0; i < rows.length; i++) {
                    if (i == Number(limit)) {
                        break;
                    }
                    //status = [];
                    name_value = $(rows[i]).find('td');
                    time = ($(name_value[Number(time_column)]).html());
                    keyword = ($(name_value[Number(keyword_column)]).html()).trim();
                    status.push([keyword, parseFloat(time), parseFloat(time), myColors[i]]);
                }
                var data = google.visualization.arrayToDataTable(status);
                var options = {
                    legend: 'none',
                    chartArea: {
                        width: "92%",
                        height: "75%"
                    },
                    bar: {
                        groupWidth: '90%'
                    },
                    annotations: {
                        alwaysOutside: true,
                        textStyle: {
                            fontName: 'Comic Sans MS',
                            fontSize: 13,
                            bold: true,
                            italic: true,
                            color: "black", // The color of the text.
                        },
                    },
                    hAxis: {
                        textStyle: {
                            fontName: 'Arial',
                            fontSize: 10,
                        }
                    },
                    vAxis: {
                        gridlines: {
                            count: 10
                        },
                        textStyle: {
                            fontName: 'Comic Sans MS',
                            fontSize: 10,
                        }
                    },
                };
                // Instantiate and draw the chart.
                var chart = new google.visualization.ColumnChart(document.getElementById(ChartID));
                chart.draw(data, options);
            }
        </script>
        <script>
            function executeDataTable(tabname, sortCol) {
                var fileTitle;
                switch (tabname) {
                    case "#sm":
                        fileTitle = "SuiteMetrics";
                        break;
                    case "#tm":
                        fileTitle = "TestMetrics";
                        break;
                    default:
                        fileTitle = "metrics";
                }

                // If already initialized, destroy before re-creating for fresh data
                if ($.fn.DataTable.isDataTable(tabname)) {
                    $(tabname).DataTable().destroy();
                }

                $(tabname).DataTable({
                    order: [ [Number(sortCol), "desc"] ],
                    dom: 'l<".margin" B>frtip',
                    lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                    buttons: [
                        {
                            extend: 'copyHtml5',
                            text: '<i class="fa fa-files-o"></i>',
                            filename: function() { return fileTitle + '-' + new Date().toLocaleString(); },
                            titleAttr: 'Copy',
                            exportOptions: { columns: ':visible' }
                        },
                        {
                            extend: 'csvHtml5',
                            text: '<i class="fa fa-file-text-o"></i>',
                            titleAttr: 'CSV',
                            filename: function() { return fileTitle + '-' + new Date().toLocaleString(); },
                            exportOptions: { columns: ':visible' }
                        },
                        {
                            extend: 'excelHtml5',
                            text: '<i class="fa fa-file-excel-o"></i>',
                            titleAttr: 'Excel',
                            filename: function() { return fileTitle + '-' + new Date().toLocaleString(); },
                            exportOptions: { columns: ':visible' }
                        },
                        {
                            extend: 'print',
                            text: '<i class="fa fa-print"></i>',
                            titleAttr: 'Print',
                            exportOptions: { columns: ':visible', alignment: 'left' }
                        },
                        {
                            extend: 'colvis',
                            collectionLayout: 'fixed two-column',
                            text: '<i class="fa fa-low-vision"></i>',
                            titleAttr: 'Hide Column',
                            exportOptions: { columns: ':visible' },
                            postfixButtons: [ 'colvisRestore' ]
                        }
                    ],
                    columnDefs: [ { visible: false } ]
                });
            }
        </script>
        <script>
            function alignTotalCount() {
                arr1 = [1, 2, 3, 4, 5];
                arr2 = ['19%', '14%', '11%', '7%', '4%'];
                zipped = arr1.map((x, i) => [x, arr2[i]]);
                var x = parseInt(%(total)%);
                size = zipped[(x.toString().length)-1][1];
                document.getElementsByClassName("total__count")[0].style.paddingLeft = `${size}`;
            }
        </script>
        <script>
            function archiveTotalCase(total, i) {
                number = [1, 2, 3, 4, 5];
                container = ['23%', '20%', '15%', '12%', '7%'];
                label = ['-24%', '-2%', '15%', '27%', '31%'];

                zipped = container.map((x, i) => [x, label[i]]);
                var x = parseInt(total);

                acontainer = zipped[(x.toString().length)-1][0];
                alabel = zipped[(x.toString().length)-1][1];

                document.getElementById(`archive-container-${i}`).style.paddingLeft = `${acontainer}`;
                document.getElementById(`archive-label-${i}`).style.marginLeft = `${alabel}`;
            }
        </script>
        <script>
            function openPage(pageName,elmnt,color,bgcolor,borderstyle) {
                var i, tabcontent, tablinks;
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }
                tablinks = document.getElementsByClassName("tablink");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].style.color = "";
                    tablinks[i].style.backgroundColor = "";
                    tablinks[i].style.borderRight = "";
                }
                document.getElementById(pageName).style.display = "block";
                elmnt.style.color = color;
                elmnt.style.backgroundColor = bgcolor; // ensure full tab background
                elmnt.style.borderRight = borderstyle;
            }
            // Get the element with id="defaultOpen" and click on it
            // Ensure we don't retain scroll from anchor hash; keep at top
            window.scrollTo(0, 0);
            document.getElementById("defaultOpen").click();
            window.scrollTo({ top: 0, behavior: 'instant' in window ? 'instant' : 'auto' });
        </script>
        <script>
            // Get the element with id="defaultOpen" and click on it
            document.getElementById("defaultOpen").click();
        </script>
        <script>
            $(window).on('load',function(){$('.loader').fadeOut();});
        </script>
        <script>
            var ctx = document.getElementById('myChart');
            var myChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['PASS', 'FAIL', 'SKIP', 'ERROR'],
                    datasets: [{
                        label: '# of Votes',
                        data: [%(_pass)%, %(fail)%, %(skip)%, %(error)%],
                        backgroundColor: [
                            '#98cc64',
                            '#fc6766',
                            '#ffd050',
                            '#b13635'
                        ],
                        hoverBackgroundColor: [
                            "#84b356",
                            "#e35857",
                            "#e4b942",
                            '#8b2828'
                        ],
                        hoverBorderColor: [
                            '#9bca6d',
                            '#fd8a89',
                            '#ffcf4c',
                            '#b13635'
                        ]
                    }]
                },
                options: {
                  doughnut_chart: true,
                  legend: {
                    display: false
                  },
                  responsive: true,
                  cutoutPercentage: 80,
                  tooltips: {
                      callbacks: {
                        title: function(tooltipItem, data) {
                            return data['labels'][tooltipItem[0]['index']];
                        },
                        label: function(tooltipItem, data) {
                            return ''
                        },
                        afterLabel: function(tooltipItem, data) {
                          var dataset = data['datasets'][0];
                          var percent = Math.round((dataset['data'][tooltipItem['index']] / dataset["_meta"][0]['total']) * 100)
                          return percent + '%';
                        }
                      },
                      backgroundColor: '#FFF',
                      titleFontSize: 16,
                      titleFontColor: '#555555',
                      bodyFontColor: '#000',
                      bodyFontSize: 14,
                      displayColors: false,
                      borderColor: '#555555',
                      borderWidth: 3,
                      multiKeyBackground: '#555555',
                      cornerRadius: 3,
                      caretSize: 15,
                      caretPadding: 13,
                      xPadding: 12,
                      yPadding: 12
                  }
                }
            });

            Chart.pluginService.register({
                beforeDraw: function(chart) {
                    if (chart.config.options.doughnut_chart) {
                        var width = chart.chart.width,
                            height = chart.chart.height,
                            ctx = chart.chart.ctx;

                        ctx.restore();
                        var fontSize = (height / 114).toFixed(2);
                        ctx.font = fontSize + "em sans-serif";
                        ctx.textBaseline = "middle";

                        var passPercent = Math.round((%(_pass)% / %(total)%) * 100)

                        var text = passPercent + "%",
                            textX = Math.round((width - ctx.measureText(text).width) / 2),
                            textY = height / 2;

                        ctx.fillText(text, textX, textY);
                        ctx.save();
                    }
                  }
                });
        </script>

        

        <script>
            var ctx = document.getElementById('groupBarChart').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: %(test_suites)%,
                    datasets: [{
                        label: 'Passed',
                        backgroundColor: '#98cc64',
                        hoverBackgroundColor: '#84b356',
                        borderColor: '#9bca6d',
                        borderWidth: 1,
                        data: %(test_suite_pass)%
                    }, {
                        label: 'Failed',
                        backgroundColor: '#fc6766',
                        hoverBackgroundColor: '#e35857',
                        borderColor: '#fd8a89',
                        borderWidth: 1,
                        data: %(test_suites_fail)%
                    }, {
                        label: 'Skipped',
                        backgroundColor: '#ffd050',
                        hoverBackgroundColor: '#e4b942',
                        borderColor: '#ffcf4c',
                        borderWidth: 1,
                        data: %(test_suites_skip)%
                    }, {
                        label: 'Error',
                        backgroundColor: '#b13635',
                        hoverBackgroundColor: '#8b2828',
                        borderColor: '#b13635',
                        borderWidth: 1,
                        data: %(test_suites_error)%
                    }]
                },
                options: {
                    title: {
                        display: false,
                        text: 'Test Suites'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: '#FFF',
                        titleFontSize: 16,
                        titleFontColor: '#555555',
                        bodyFontColor: '#000',
                        bodyFontSize: 14,
                        displayColors: false,
                        borderColor: '#555555',
                        borderWidth: 3,
                        multiKeyBackground: '#555555',
                        cornerRadius: 3,
                        caretSize: 15,
                        caretPadding: 13,
                        xPadding: 12,
                        yPadding: 12
                    },
                    legend: {
                        display: false
                    },
                    responsive: true,
                    scales: {
                        xAxes: [{
                            stacked: true
                        }],
                        yAxes: [{
                            stacked: true,
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        </script>
        <script>
            var durCanvas = document.getElementById('durations').getContext("2d");
            // Use numeric test indices on X-axis; keep full labels for tooltips
            var durLabels = %(duration_labels)%;
            var durValues = %(duration_values)%;
            var indexLabels = durValues.map(function(_, i) { return i + 1; });
            var durationsChart = new Chart(durCanvas, {
                type: 'line',
                data: {
                  labels : indexLabels,
                  datasets : [
                    {
                      label: 'Duration (s)',
                      backgroundColor: 'rgba(74,172,197,0.15)',
                      borderColor: '#4AACC5',
                      pointBackgroundColor: '#4AACC5',
                      pointBorderColor: '#4AACC5',
                      fill: false,
                      lineTension: 0.2,
                      borderWidth: 2,
                      data : durValues
                    }
                  ]
                },
                options : {
                    legend: { display: false },
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                      xAxes: [{
                        scaleLabel: { display: true, labelString: 'Test #' },
                        ticks: { autoSkip: true, maxRotation: 0, minRotation: 0 }
                      }],
                      yAxes: [{
                        scaleLabel: { display: true, labelString: 'Seconds' },
                        ticks: { beginAtZero: true }
                      }]
                    },
                    tooltips: {
                        mode: 'nearest',
                        intersect: false,
                        backgroundColor: '#FFF',
                        titleFontSize: 14,
                        titleFontColor: '#555555',
                        bodyFontColor: '#000',
                        bodyFontSize: 12,
                        displayColors: false,
                        borderColor: '#555555',
                        borderWidth: 2,
                        cornerRadius: 3,
                        callbacks: {
                          title: function(tooltipItems, data) {
                            if (tooltipItems && tooltipItems.length) {
                              return 'Test #'+ (tooltipItems[0].index + 1);
                            }
                            return '';
                          },
                          beforeLabel: function(tooltipItem, data) {
                            return durLabels[tooltipItem.index];
                          },
                          label: function(tooltipItem, data) {
                            return 'Duration: ' + durValues[tooltipItem.index] + ' s';
                          }
                        }
                    }
                }
            });
        </script>
        <script>
            function failureScreenshots() {
                $('.video').hover(function (e) {
                  var hoverText = $(this).siblings('.text-desc').html();

                  $(e.target).closest('.bg-highlight').find('.below-desc').first().html(hoverText);
                }, function (e) {
                  $(e.target).closest('.bg-highlight').find('.below-desc').first().html('');
                });
            }

            $('#download').click(function () {
                domtoimage.toPng(document.getElementById('dashboard'))
                .then(function (blob) {
                    var pdf = new jsPDF('l', 'pt', [$('#dashboard').width()+20, $('#dashboard').height()]);
                    pdf.addImage(blob, 'PNG', 10, 10, $('#dashboard').width(), $('#dashboard').height());
                    pdf.save("pytest_html_reporter.pdf");
                });
            });
        </script>

    </body>
</html>